{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/DevProjects/prospra/components/dashboard/SuccessCoachDock.tsx"],"sourcesContent":["// /components/dashboard/SuccessCoachDock.tsx\r\n\r\n\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\n\r\ntype Message = {\r\n  id: string;\r\n  role: \"user\" | \"assistant\";\r\n  content: string;\r\n};\r\n\r\nexport function SuccessCoachDock() {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [isMinimized, setIsMinimized] = useState(false);\r\n  const [messages, setMessages] = useState<Message[]>([\r\n    {\r\n      id: \"welcome\",\r\n      role: \"assistant\",\r\n      content:\r\n        \"Hey founder – I’m your AI Success Coach. What’s the #1 thing you want help with this week?\",\r\n    },\r\n  ]);\r\n  const [input, setInput] = useState(\"\");\r\n  const [isSending, setIsSending] = useState(false);\r\n  const containerRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!isOpen || !containerRef.current) return;\r\n    containerRef.current.scrollTop = containerRef.current.scrollHeight;\r\n  }, [messages, isOpen]);\r\n\r\n  async function handleSend(e?: React.FormEvent) {\r\n    e?.preventDefault();\r\n    if (!input.trim() || isSending) return;\r\n\r\n    const userMessage: Message = {\r\n      id: `user-${Date.now()}`,\r\n      role: \"user\",\r\n      content: input.trim(),\r\n    };\r\n\r\n    setMessages((prev) => [...prev, userMessage]);\r\n    setInput(\"\");\r\n    setIsSending(true);\r\n\r\n    try {\r\n      const res = await fetch(\"/api/chat\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          mode: \"success-coach\",\r\n          messages: [\r\n            {\r\n              role: \"system\",\r\n              content:\r\n                \"You are Prospra, an AI Success Coach for entrepreneurs. Be practical, encouraging, and focused on concrete next steps tied to their goals and founder score.\",\r\n            },\r\n            ...messages,\r\n            userMessage,\r\n          ].map((m) => ({ role: m.role, content: m.content })),\r\n        }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        throw new Error(\"Request failed\");\r\n      }\r\n\r\n      const data = await res.json();\r\n\r\n      const assistantMessage: Message = {\r\n        id: `assistant-${Date.now()}`,\r\n        role: \"assistant\",\r\n        content: data.reply ?? \"I’m here – let’s break this down together.\",\r\n      };\r\n\r\n      setMessages((prev) => [...prev, assistantMessage]);\r\n    } catch (err) {\r\n      console.error(\"[SUCCESS_COACH_ERROR]\", err);\r\n      const errorMessage: Message = {\r\n        id: `error-${Date.now()}`,\r\n        role: \"assistant\",\r\n        content:\r\n          \"Hmm, something glitched on my side. Try again in a moment – or refresh the page.\",\r\n      };\r\n      setMessages((prev) => [...prev, errorMessage]);\r\n    } finally {\r\n      setIsSending(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {/* FAB button */}\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => {\r\n          setIsOpen((prev) => !prev);\r\n          setIsMinimized(false);\r\n        }}\r\n        className=\"fixed bottom-4 right-4 z-40 flex items-center gap-2 rounded-full bg-gradient-to-r from-orange-500 to-blue-500 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-black/30 transition hover:scale-105 hover:shadow-xl\"\r\n      >\r\n        <span>Success Coach</span>\r\n        <span className=\"h-2 w-2 animate-pulse rounded-full bg-emerald-300\" />\r\n      </button>\r\n\r\n      {/* Chat window */}\r\n      {isOpen && (\r\n        <div className=\"fixed bottom-20 right-4 z-40 flex w-full max-w-sm flex-col rounded-2xl bg-[#050816]/95 p-3 text-sm text-slate-100 shadow-2xl shadow-black/50 backdrop-blur-lg border border-white/10\">\r\n          <div className=\"flex items-center justify-between gap-2 pb-2\">\r\n            <div>\r\n              <p className=\"text-xs uppercase tracking-[0.2em] text-orange-300/80\">\r\n                AI Success Coach\r\n              </p>\r\n              <p className=\"text-[0.78rem] text-slate-400\">\r\n                Get a quick gameplan in 2–3 messages.\r\n              </p>\r\n            </div>\r\n            <div className=\"flex items-center gap-1\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setIsMinimized((prev) => !prev)}\r\n                className=\"rounded-full p-1 hover:bg-white/10\"\r\n              >\r\n                {isMinimized ? \"▴\" : \"▾\"}\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setIsOpen(false)}\r\n                className=\"rounded-full p-1 hover:bg-white/10\"\r\n              >\r\n                ✕\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {!isMinimized && (\r\n            <>\r\n              <div\r\n                ref={containerRef}\r\n                className=\"mb-2 max-h-64 space-y-2 overflow-y-auto pr-1 custom-scrollbar\"\r\n              >\r\n                {messages.map((m) => (\r\n                  <div\r\n                    key={m.id}\r\n                    className={`flex ${\r\n                      m.role === \"user\" ? \"justify-end\" : \"justify-start\"\r\n                    }`}\r\n                  >\r\n                    <div\r\n                      className={`rounded-xl px-3 py-2 text-[0.8rem] leading-snug ${\r\n                        m.role === \"user\"\r\n                          ? \"bg-blue-600/80 text-slate-50\"\r\n                          : \"bg-white/5 text-slate-100 border border-white/5\"\r\n                      }`}\r\n                    >\r\n                      {m.content}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n\r\n              <form onSubmit={handleSend} className=\"flex items-center gap-2 pt-1\">\r\n                <input\r\n                  value={input}\r\n                  onChange={(e) => setInput(e.target.value)}\r\n                  placeholder=\"Ask about your next move...\"\r\n                  className=\"flex-1 rounded-full border border-white/10 bg-black/40 px-3 py-1.5 text-[0.8rem] outline-none placeholder:text-slate-500 focus:border-orange-400/80\"\r\n                />\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={isSending || !input.trim()}\r\n                  className=\"rounded-full bg-gradient-to-r from-orange-500 to-blue-500 px-3 py-1.5 text-[0.75rem] font-semibold text-white shadow-md shadow-black/40 disabled:cursor-not-allowed disabled:opacity-50\"\r\n                >\r\n                  {isSending ? \"...\" : \"Send\"}\r\n                </button>\r\n              </form>\r\n            </>\r\n          )}\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,6CAA6C;;;;;;AAI7C;AAFA;;;AAUO,SAAS;IACd,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAC/C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAY;QAClD;YACE,IAAI;YACJ,MAAM;YACN,SACE;QACJ;KACD;IACD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,eAAe,IAAA,+MAAM,EAAwB;IAEnD,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,UAAU,CAAC,aAAa,OAAO,EAAE;QACtC,aAAa,OAAO,CAAC,SAAS,GAAG,aAAa,OAAO,CAAC,YAAY;IACpE,GAAG;QAAC;QAAU;KAAO;IAErB,eAAe,WAAW,CAAmB;QAC3C,GAAG;QACH,IAAI,CAAC,MAAM,IAAI,MAAM,WAAW;QAEhC,MAAM,cAAuB;YAC3B,IAAI,CAAC,KAAK,EAAE,KAAK,GAAG,IAAI;YACxB,MAAM;YACN,SAAS,MAAM,IAAI;QACrB;QAEA,YAAY,CAAC,OAAS;mBAAI;gBAAM;aAAY;QAC5C,SAAS;QACT,aAAa;QAEb,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,aAAa;gBACnC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBACnB,MAAM;oBACN,UAAU;wBACR;4BACE,MAAM;4BACN,SACE;wBACJ;2BACG;wBACH;qBACD,CAAC,GAAG,CAAC,CAAC,IAAM,CAAC;4BAAE,MAAM,EAAE,IAAI;4BAAE,SAAS,EAAE,OAAO;wBAAC,CAAC;gBACpD;YACF;YAEA,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,MAAM,mBAA4B;gBAChC,IAAI,CAAC,UAAU,EAAE,KAAK,GAAG,IAAI;gBAC7B,MAAM;gBACN,SAAS,KAAK,KAAK,IAAI;YACzB;YAEA,YAAY,CAAC,OAAS;uBAAI;oBAAM;iBAAiB;QACnD,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,yBAAyB;YACvC,MAAM,eAAwB;gBAC5B,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG,IAAI;gBACzB,MAAM;gBACN,SACE;YACJ;YACA,YAAY,CAAC,OAAS;uBAAI;oBAAM;iBAAa;QAC/C,SAAU;YACR,aAAa;QACf;IACF;IAEA,qBACE;;0BAEE,8OAAC;gBACC,MAAK;gBACL,SAAS;oBACP,UAAU,CAAC,OAAS,CAAC;oBACrB,eAAe;gBACjB;gBACA,WAAU;;kCAEV,8OAAC;kCAAK;;;;;;kCACN,8OAAC;wBAAK,WAAU;;;;;;;;;;;;YAIjB,wBACC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;;kDACC,8OAAC;wCAAE,WAAU;kDAAwD;;;;;;kDAGrE,8OAAC;wCAAE,WAAU;kDAAgC;;;;;;;;;;;;0CAI/C,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCACC,MAAK;wCACL,SAAS,IAAM,eAAe,CAAC,OAAS,CAAC;wCACzC,WAAU;kDAET,cAAc,MAAM;;;;;;kDAEvB,8OAAC;wCACC,MAAK;wCACL,SAAS,IAAM,UAAU;wCACzB,WAAU;kDACX;;;;;;;;;;;;;;;;;;oBAMJ,CAAC,6BACA;;0CACE,8OAAC;gCACC,KAAK;gCACL,WAAU;0CAET,SAAS,GAAG,CAAC,CAAC,kBACb,8OAAC;wCAEC,WAAW,CAAC,KAAK,EACf,EAAE,IAAI,KAAK,SAAS,gBAAgB,iBACpC;kDAEF,cAAA,8OAAC;4CACC,WAAW,CAAC,gDAAgD,EAC1D,EAAE,IAAI,KAAK,SACP,iCACA,mDACJ;sDAED,EAAE,OAAO;;;;;;uCAZP,EAAE,EAAE;;;;;;;;;;0CAkBf,8OAAC;gCAAK,UAAU;gCAAY,WAAU;;kDACpC,8OAAC;wCACC,OAAO;wCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;wCACxC,aAAY;wCACZ,WAAU;;;;;;kDAEZ,8OAAC;wCACC,MAAK;wCACL,UAAU,aAAa,CAAC,MAAM,IAAI;wCAClC,WAAU;kDAET,YAAY,QAAQ;;;;;;;;;;;;;;;;;;;;;;AASvC"}}]
}